function getRootSvg(){for(var e=document.body.childNodes,n=e.length,t=0;t<n;t++){var i=e[t];if("svg"===i.tagName||"SVG"===i.tagName)return i}return!1}function createRootSvg(){var e=document.createElementNS(NAMESPACE_SVG,"svg");return e.setAttribute("height","0"),document.body.appendChild(e),e}function createSvgUse(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=document.createElementNS(NAMESPACE_SVG,"svg");for(var i in n)t.setAttribute(i,n[i]);var o=document.createElementNS(NAMESPACE_SVG,"use");return o.setAttributeNS(NAMESPACE_XLINK,"xlink:href","#"+e),t.appendChild(o),t}function changeSvgIcon(e,n){e.firstChild.setAttributeNS(NAMESPACE_XLINK,"xlink:href","#"+n)}function getSvgIcon(e){return e.firstChild.getAttributeNS(NAMESPACE_XLINK,"href").slice(1)}function rgbaToColorMatrix(e,n,t){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=function(e){return Math.round(e/255*10)/10},r=o(e),a=o(n),s=o(t),c=o(i);return"0 0 0 0 "+r+" 0 0 0 0 "+a+" 0 0 0 0 "+s+" 0 0 0 1 "+c}function getIdForSvgColorFilter(e,n,t){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return"__bunny_filter_"+e+"_"+n+"_"+t+"_"+i}function createOrGetSvgColorFilter(e,n,t){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=getIdForSvgColorFilter(e,n,t,i),r=getRootSvg();if(r===!1&&(r=createRootSvg()),!document.getElementById(o)){var a=document.createElementNS("http://www.w3.org/2000/svg","filter");a.setAttribute("id",o),a.innerHTML='<feColorMatrix type="matrix" values="'+rgbaToColorMatrix(e,n,t,i)+'" />',r.appendChild(a)}return o}function applySvgColorFilterToElement(e,n,t,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=createOrGetSvgColorFilter(n,t,i,o);e.style.filter="url(#"+r+")"}void 0===Object.getOwnPropertyDescriptor(Element.prototype,"classList")&&Object.defineProperty(Element.prototype,"classList",Object.getOwnPropertyDescriptor(HTMLElement.prototype,"classList"));var NAMESPACE_SVG="http://www.w3.org/2000/svg",NAMESPACE_XLINK="http://www.w3.org/1999/xlink",SpinnerConfig={icon:"spinner",className:"i-spinner",tagNameFade:"fade",classNameFade:null,classNameFadeShow:"show",animationDuration:600},Spinner={Config:SpinnerConfig,insertSpinner:function(e,n){e.appendChild(n)},removeSpinner:function(e,n){e.removeChild(n)},getSpinner:function(e){return e.__bunny_spinner||!1},has:function(e){return void 0!==e.__bunny_spinner},show:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"SVG"===e.tagName||"svg"===e.tagName?(e.__bunny_spinner=getSvgIcon(e),changeSvgIcon(e,this.Config.icon),e.classList.add(this.Config.className)):(n&&(e.__bunny_spinner_text=e.innerHTML,e.textContent=""),e.__bunny_spinner=createSvgUse(this.Config.icon,{class:this.Config.className}),this.insertSpinner(e,e.__bunny_spinner))},hide:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"SVG"===e.tagName||"svg"===e.tagName?(e.classList.remove(this.Config.className),changeSvgIcon(e,e.__bunny_spinner)):(this.removeSpinner(e,e.__bunny_spinner),n&&(e.innerHTML=e.__bunny_spinner_text,delete e.__bunny_spinner_text)),delete e.__bunny_spinner},toggle:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.has(e)?(this.hide(e,n),!0):(this.show(e,n),!1)},fadePage:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new Promise(function(i){var o=e.getFade();o?i():!function(){var o=document.createElement(e.Config.tagNameFade);null!==e.Config.classNameFade&&o.classList.add(e.Config.classNameFade);var r=document.createElement("div");r.classList.add("fade"),t&&r.classList.add(t),o.appendChild(r),document.body.appendChild(o),setTimeout(function(){null!==n&&(r.textContent=n,r.classList.add("in")),e.toggle(o),o.classList.add(e.Config.classNameFadeShow),setTimeout(function(){i()},e.Config.animationDuration)},0)}()})},getFade:function(){return document.getElementsByTagName(this.Config.tagNameFade)[0]||!1},getFadeIcon:function(){return this.getSpinner(this.getFade())},getFadeText:function(){return this.getFade().getElementsByTagName("div")[0]},unfadePage:function(){var e=this;return new Promise(function(n){var t=e.getFade();t?(t.classList.remove(e.Config.classNameFadeShow),setTimeout(function(){document.body.removeChild(t),n()},e.Config.animationDuration)):n()})},setFadeIcon:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=this.getFadeIcon();t.classList.remove(this.Config.className),changeSvgIcon(t,e),n&&t.classList.add(n)},setFadeText:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=this.getFadeText();t.classList.remove("in"),setTimeout(function(){t.textContent=e,n&&t.setAttribute("class",n),t.classList.add("in")},300)}};Object.assign(AutocompleteConfig,{iconSearch:"search"}),Object.assign(AutocompleteUI,{getIcon:function(e){return e.getElementsByTagName("svg")[0]},createIcon:function(){return createSvgUse(this.Config.iconSearch)},insertIcon:function(e,n){e.appendChild(n)}}),Object.assign(Autocomplete,{initIcons:function(e){var n=this,t=this.UI.createIcon();this.UI.insertIcon(e,t),this.onBeforeUpdate(e,function(){n.showSpinner(e)}),this.onUpdate(e,function(t,i){n.hideSpinner(e)})},showSpinner:function(e){Spinner.toggle(this.UI.getIcon(e))},hideSpinner:function(e){Spinner.toggle(this.UI.getIcon(e))}});